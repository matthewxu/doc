use strict 'vars';
use warnings;
no warnings qw(uninitialized numeric);
use Encode;
use utf8;
binmode(STDIN, ':encoding(utf8)');
binmode(STDOUT, ':encoding(utf8)');
binmode(STDERR, ':encoding(utf8)');
use HTML::DOM;
use IO::Handle;
use Getopt::Long;
use Data::Dumper;
use LWP::UserAgent;
use LWP::ConnCache;
use HTTP::Cookies;
use HTTP::Response;
use HTML::Form;
use JSON;
use Sys::Hostname;	
use HTML::TreeBuilder;

my $cookiefile='cookiefile';
my $HTTPSHOST = 'http://www.google.com';
my $firsturl  = $HTTPSHOST;
my $logouturl = $HTTPSHOST."/prdhp?hl=zh-cn&tab=ff";
$logouturl='http://www.smarter.com.cn/computers-553/category/stdcomponent-554/';
my $ua = LWP::UserAgent->new;
my $cookies = new HTTP::Cookies(file=>$cookiefile,autosave=>1,);
my $lwpconncache = $ua->conn_cache(LWP::ConnCache->new());
$ua->conn_cache->total_capacity(undef);
$ua->no_proxy();
$ua->agent('Mozilla/5.0 (Windows; U; Windows NT 6.1; zh-CN; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.3');
$ua->cookie_jar($cookies);
$ua->timeout(300);
$ua->requests_redirectable (['GET', 'HEAD', 'POST']);
#print "cookie : ".$cookies->as_string."\n";
#$ua->default_headers('Accept'=>'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8');
#$ua->default_headers('Accept-Language'=>'en');
#$ua->default_headers('Accept-Encoding'=>'gzip,deflate');
#$ua->default_headers('Accept-Charset'=>'utf-8');
#$ua->default_headers('Keep-Alive'=>115);
#$ua->default_headers('Connection'=>'keep-alive');
#$ua->local_address("127.0.0.1");
$ua->max_redirect(20);
$ua->show_progress(1);

my $response = $ua->get($logouturl);

my $string=$response->content();
my $tree = new HTML::TreeBuilder();
$string=$tree->parse_content($string)->as_XML();
print $string; 
#my $dom=new HTML::DOM;
#$dom->parse_file('t.t');
#print $dom->title, "\n";
#print Dumper $dom->body,"\n";
#print  $dom->images,"\n";
exit 0;
